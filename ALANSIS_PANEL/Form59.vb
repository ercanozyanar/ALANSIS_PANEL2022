Imports System.Data.SqlClient
Imports System.Data
Imports System.Net.Sockets

Public Class Form59
    Dim SqlConnStr As String = "server=10.3.11.61;database=ALANSIS;uid=sa;pwd=term.0907;"
    Dim SqlConn As New System.Data.SqlClient.SqlConnection(SqlConnStr)
    Private Sub Form59_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        TextBox2.Text = TextBox1.Text & "-" & Date.Now.Year & Date.Now.Month & Date.Now.Day & Date.Now.Minute & Date.Now.Second
        '================================================================================================================================
        '*** PARTI BILGISINE GORE RECETE
        SqlConn.Open()
        Dim mySelectQuery1 As String = "SELECT STOK_ADI FROM EO_ALANSIS_YARDDEPO"
        Dim SqlComm1 As New System.Data.SqlClient.SqlCommand(mySelectQuery1, SqlConn)
        Dim reader1 As System.Data.SqlClient.SqlDataReader
        reader1 = SqlComm1.ExecuteReader()
        While reader1.Read()
            ComboBox1.Items.Add(reader1("STOK_ADI"))
            ComboBox3.Items.Add(reader1("STOK_ADI"))
            ComboBox4.Items.Add(reader1("STOK_ADI"))
            ComboBox5.Items.Add(reader1("STOK_ADI"))
            ComboBox6.Items.Add(reader1("STOK_ADI"))
            ComboBox7.Items.Add(reader1("STOK_ADI"))
            ComboBox8.Items.Add(reader1("STOK_ADI"))
            ComboBox9.Items.Add(reader1("STOK_ADI"))
            ComboBox10.Items.Add(reader1("STOK_ADI"))
        End While
        reader1.Close()
        SqlConn.Close()
        '================================================================================================================================


    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        On Error GoTo hata
        Dim conn1, conn2 As New SqlConnection
        Dim cmd1, cmd2, cmd3 As New SqlCommand
        conn2.ConnectionString = "server=10.3.11.61;database=ALANSIS;uid=sa;pwd=term.0907;"
        If ComboBox1.Text <> "" Then
            '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
            conn2.Open()
            cmd2.Connection = conn2
            cmd2.CommandText = "INSERT INTO EO_ALANSIS_RECETE(PARTINO,TIP,STOK_ADI,MIKTAR,RENK,RECETE_INDEKS) VALUES ( '" & TextBox1.Text & "','Uretim_Recete','" & ComboBox1.Text & "','" & Replace(TextBox3.Text, ",", ".") & "','" & ComboBox2.Text & "','" & TextBox2.Text & "')"
            cmd2.ExecuteNonQuery()
            conn2.Close()
        End If
        '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
        If ComboBox3.Text <> "" Then
            '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
            conn2.Open()
            cmd2.Connection = conn2
            cmd2.CommandText = "INSERT INTO EO_ALANSIS_RECETE(PARTINO,TIP,STOK_ADI,MIKTAR,RENK,RECETE_INDEKS) VALUES ( '" & TextBox1.Text & "','Uretim_Recete','" & ComboBox3.Text & "','" & Replace(TextBox4.Text, ",", ".") & "','" & ComboBox2.Text & "','" & TextBox2.Text & "')"
            cmd2.ExecuteNonQuery()
            conn2.Close()
        End If
        '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
        If ComboBox4.Text <> "" Then
            '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
            conn2.Open()
            cmd2.Connection = conn2
            cmd2.CommandText = "INSERT INTO EO_ALANSIS_RECETE(PARTINO,TIP,STOK_ADI,MIKTAR,RENK,RECETE_INDEKS) VALUES ( '" & TextBox1.Text & "','Uretim_Recete','" & ComboBox4.Text & "','" & Replace(TextBox5.Text, ",", ".") & "','" & ComboBox2.Text & "','" & TextBox2.Text & "')"
            cmd2.ExecuteNonQuery()
            conn2.Close()
        End If
        '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================

        If ComboBox5.Text <> "" Then
            '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
            conn2.Open()
            cmd2.Connection = conn2
            cmd2.CommandText = "INSERT INTO EO_ALANSIS_RECETE(PARTINO,TIP,STOK_ADI,MIKTAR,RENK,RECETE_INDEKS) VALUES ( '" & TextBox1.Text & "','Uretim_Recete','" & ComboBox5.Text & "','" & Replace(TextBox6.Text, ",", ".") & "','" & ComboBox2.Text & "','" & TextBox2.Text & "')"
            cmd2.ExecuteNonQuery()
            conn2.Close()
        End If
        '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
        If ComboBox6.Text <> "" Then
            '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
            conn2.Open()
            cmd2.Connection = conn2
            cmd2.CommandText = "INSERT INTO EO_ALANSIS_RECETE(PARTINO,TIP,STOK_ADI,MIKTAR,RENK,RECETE_INDEKS) VALUES ( '" & TextBox1.Text & "','Uretim_Recete','" & ComboBox6.Text & "','" & Replace(TextBox7.Text, ",", ".") & "','" & ComboBox2.Text & "','" & TextBox2.Text & "')"
            cmd2.ExecuteNonQuery()
            conn2.Close()
        End If
        '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
        If ComboBox7.Text <> "" Then
            '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
            conn2.Open()
            cmd2.Connection = conn2
            cmd2.CommandText = "INSERT INTO EO_ALANSIS_RECETE(PARTINO,TIP,STOK_ADI,MIKTAR,RENK,RECETE_INDEKS) VALUES ( '" & TextBox1.Text & "','Uretim_Recete','" & ComboBox7.Text & "','" & Replace(TextBox8.Text, ",", ".") & "','" & ComboBox2.Text & "','" & TextBox2.Text & "')"
            cmd2.ExecuteNonQuery()
            conn2.Close()
        End If
        '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
        If ComboBox8.Text <> "" Then
            '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
            conn2.Open()
            cmd2.Connection = conn2
            cmd2.CommandText = "INSERT INTO EO_ALANSIS_RECETE(PARTINO,TIP,STOK_ADI,MIKTAR,RENK,RECETE_INDEKS) VALUES ( '" & TextBox1.Text & "','Uretim_Recete','" & ComboBox8.Text & "','" & Replace(TextBox9.Text, ",", ".") & "','" & ComboBox2.Text & "','" & TextBox2.Text & "')"
            cmd2.ExecuteNonQuery()
            conn2.Close()
        End If
        '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
        If ComboBox9.Text <> "" Then
            '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
            conn2.Open()
            cmd2.Connection = conn2
            cmd2.CommandText = "INSERT INTO EO_ALANSIS_RECETE(PARTINO,TIP,STOK_ADI,MIKTAR,RENK,RECETE_INDEKS) VALUES ( '" & TextBox1.Text & "','Uretim_Recete','" & ComboBox9.Text & "','" & Replace(TextBox10.Text, ",", ".") & "','" & ComboBox2.Text & "','" & TextBox2.Text & "')"
            cmd2.ExecuteNonQuery()
            conn2.Close()
        End If
        '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
        If ComboBox10.Text <> "" Then
            '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
            conn2.Open()
            cmd2.Connection = conn2
            cmd2.CommandText = "INSERT INTO EO_ALANSIS_RECETE(PARTINO,TIP,STOK_ADI,MIKTAR,RENK,RECETE_INDEKS) VALUES ( '" & TextBox1.Text & "','Uretim_Recete','" & ComboBox10.Text & "','" & Replace(TextBox11.Text, ",", ".") & "','" & ComboBox2.Text & "','" & TextBox2.Text & "')"
            cmd2.ExecuteNonQuery()
            conn2.Close()
        End If
        '========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
        MessageBox.Show("Kayit İşlemi Tamamlanmiştir...")



        If TextBox3.Text = "INCIR" Then
            Form47.TextBox12.Text = TextBox2.Text
            Me.Close()
        End If
        If TextBox3.Text = "NAR" Then
            Form62.TextBox12.Text = TextBox2.Text
            Me.Close()
        End If
        Exit Sub
hata:
        MessageBox.Show("Kayit İşleminde Hata, Lütfen Kontrol Ediniz...")
        Exit Sub
    End Sub
End Class